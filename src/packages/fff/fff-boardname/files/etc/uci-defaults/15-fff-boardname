#!/bin/ash

BOARD="$(cat /var/sysinfo/board_name)"

case "$BOARD" in
	archer-c7)
		BOARD=archer-c7-v2
		;;
	bullet-m)
		grep -i "Loco" /var/sysinfo/model && BOARD=loco-m
		grep -i "Pico" /var/sysinfo/model && BOARD=pico-m
		;;
	loco-m-xw)
		grep -i "Power" /var/sysinfo/model && BOARD=power-m-xw
		;;
	tl-mr3020|\
	tl-wa850re|\
	tl-wa860re|\
	tl-wdr3500|\
	tl-wr1043nd)
		BOARD="$BOARD-v1"
		;;
	tl-wdr4300)
		BOARD=tl-wdr4300-v1
		grep "3600" /var/sysinfo/model && BOARD=tl-wdr3600-v1
		grep "4310" /var/sysinfo/model && BOARD=tl-wdr4310-v1
		;;
	tl-wr1043nd-v2)
		grep "v3" /var/sysinfo/model && BOARD=tl-wr1043nd-v3
		;;
	tl-wr741nd)
		BOARD=tl-wr741nd-v4
		grep "Atheros AR7240 rev 2" /proc/cpuinfo && BOARD=tl-wr741nd-v2
		;;
	tl-wr741nd-v4)
		grep 740 /var/sysinfo/model && BOARD=tl-wr740n-v4
		;;
	tl-wr841n*)
		BOARD="${BOARD/841n/841}"
		grep "v10" /var/sysinfo/model && BOARD=tl-wr841-v10
		grep "v12" /var/sysinfo/model && BOARD=tl-wr841-v12
		;;
	tplink,c50-v4)
		BOARD=tplink,archer-c50-v4
		;;
	unifiac-lite)
		grep -i "MESH" /var/sysinfo/model && BOARD=unifiac-mesh
		;;
	unifiac-pro)
		grep -i "MESH-PRO" /var/sysinfo/model && BOARD=unifiac-mesh-pro
		;;
esac

uci set board.model.name="$BOARD"
uci commit board
